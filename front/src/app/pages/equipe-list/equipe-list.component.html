<div class="liste">
    <h3>
        @if (routerURL =="/equipes") {
        LISTE DES EQUIPES
        }
        @else if (routerURL == "/accueil") {
        <a routerLink="/equipes">LISTE DES EQUIPES</a>
        }
    </h3>
    @if (routerURL == "/equipes") {
    <form class="filtrage" [formGroup]="formFiltrage">
        <select title="filtrage-demande" class="filtrage-demande" formControlName="filtrageDemande"
            (change)="updateFiltrage()">
            <option disabled [selected]="formFiltrage.value.filtrageDemande == ''">-- Sélectionner un filtre --</option>
            <option value="Par libellé d'équipe">Rechercher par libellé d'équipe</option>
        </select>
        @if (formFiltrage.get("filtrageDemande")?.getRawValue() == "Par libellé d'équipe") {
        <select title="noms-equipe" id="noms-equipe" autocomplete formControlName="equipeRecherche">
            <option disabled [selected]="formFiltrage.value.filtrageDemande == 'Par libellé d\'équipe'">-- Sélectionner
                un
                libellé d'équipe --</option>
            @for (libelleEquipe of listLibellesEquipe; track $index) {
            <option [value]="libelleEquipe">{{ libelleEquipe }}</option>
            }
        </select>
        }
        <input type="submit" id="btn-soumission" formControlName="boutonSoumission" (click)="onSearch()">
        <input type="reset" id="btn-reset" (click)="onReset()" formControlName="boutonReset">
    </form>
    }

    <!-- TODO: Faire en sorte d'avoir les 10 dernières équipes ajoutées (du CP ou de l'admin) sur la page d'accueil -->
    <div class="table">
        <table border="2">
            @if (routerURL =="/equipes") {
            <thead>
                <tr>
                    <th>Libellé</th>
                    <th>Utilisateurs membres</th>
                    <th>Compositions intégrées</th>
                    <th>Modifier</th>
                    <th>Supprimer</th>
                </tr>
            </thead>
            <tbody>
                @for (equipe of listEquipes; track $index) {
                <tr title="{{ equipe.idEquipe }}">
                    <td>{{ equipe.libelle }}</td>
                    <td>
                        @for (utilisateur of equipe.listUtilisateurs; track $index){
                        <ul>
                            <li>Utilisateur n°{{ utilisateur[0] }}</li>
                            <li>{{ utilisateur[1] }} {{ utilisateur[2]}}</li>
                        </ul>
                        <br>
                        }
                    </td>
                    <td>
                        @for (composition of equipe.listCompositions; track $index){
                        <ul>
                            <li>Composition n°{{ composition[0] }}</li>
                            <li>Equipe {{ composition[1] }}</li>
                            <li>Utilisateur {{ composition[2] }} {{ composition[3] }}</li>
                        </ul>
                        <br>
                        }
                    </td>
                    <td><button type="button" routerLink="/equipes/update/"
                            [queryParams]="{ id: equipe.idEquipe}">Modifier</button></td>
                    <td><button type="button" (click)="onDeleteEquipe(equipe.idEquipe.toString())">Supprimer</button>
                    </td>
                </tr>
                }
            </tbody>
            } @else if (routerURL =="/accueil") {
            <thead>
                <tr>
                    <th>Libellé</th>
                    <th>Utilisateurs membres</th>
                </tr>
            </thead>
            <tbody>
                @for (equipe of listEquipes; track $index) {
                <tr title="{{ equipe.idEquipe }}">
                    <td>{{ equipe.libelle }}</td>
                    <td>
                        @for (utilisateur of equipe.listUtilisateurs; track $index){
                        <ul>
                            <li>Utilisateur n°{{ utilisateur[0] }}</li>
                            <li>{{ utilisateur[1] }} {{ utilisateur[2]}}</li>
                        </ul>
                        <br>
                        }
                    </td>
                </tr>
                }
            </tbody>
            }
        </table>
    </div>
</div>